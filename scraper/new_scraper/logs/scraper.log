2022-01-01 00:06:51,845 - scrapper - INFO - Scraping data...
2022-01-01 00:06:57,182 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:06:57,263 - root - INFO - Data added to db!
2022-01-01 00:07:00,768 - scrapper - INFO - Scraping data...
2022-01-01 00:07:05,541 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:07:05,570 - root - INFO - Data added to db!
2022-01-01 00:13:03,527 - scrapper - INFO - Scraping data...
2022-01-01 00:13:06,958 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:13:06,997 - root - INFO - Data added to db!
2022-01-01 00:13:26,035 - scrapper - INFO - Scraping data...
2022-01-01 00:13:29,603 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:13:29,636 - root - INFO - Data added to db!
2022-01-01 00:16:15,639 - scrapper - INFO - Scraping data...
2022-01-01 00:16:18,908 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:16:18,952 - root - INFO - Data added to db!
2022-01-01 00:21:01,947 - scrapper - INFO - Scraping data...
2022-01-01 00:21:05,507 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:21:05,534 - root - INFO - Data added to db!
2022-01-01 00:22:02,479 - scrapper - INFO - Scraping data...
2022-01-01 00:22:05,938 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:22:05,964 - root - INFO - Data added to db!
2022-01-01 00:23:01,949 - scrapper - INFO - Scraping data...
2022-01-01 00:23:06,020 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:23:06,048 - root - INFO - Data added to db!
2022-01-01 00:24:02,052 - scrapper - INFO - Scraping data...
2022-01-01 00:24:05,736 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:24:05,765 - root - INFO - Data added to db!
2022-01-01 00:25:02,873 - scrapper - INFO - Scraping data...
2022-01-01 00:25:06,314 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:25:06,343 - root - INFO - Data added to db!
2022-01-01 00:26:02,562 - scrapper - INFO - Scraping data...
2022-01-01 00:26:06,473 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:26:06,501 - root - INFO - Data added to db!
2022-01-01 00:27:02,499 - scrapper - INFO - Scraping data...
2022-01-01 00:27:05,872 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:27:05,899 - root - INFO - Data added to db!
2022-01-01 00:28:02,456 - scrapper - INFO - Scraping data...
2022-01-01 00:28:07,980 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:28:08,030 - root - INFO - Data added to db!
2022-01-01 00:29:02,420 - scrapper - INFO - Scraping data...
2022-01-01 00:29:05,898 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:29:05,941 - root - INFO - Data added to db!
2022-01-01 00:30:02,095 - scrapper - INFO - Scraping data...
2022-01-01 00:30:06,613 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:30:06,634 - root - INFO - Data added to db!
2022-01-01 00:31:02,927 - scrapper - INFO - Scraping data...
2022-01-01 00:31:07,431 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:31:07,460 - root - INFO - Data added to db!
2022-01-01 00:32:03,318 - scrapper - INFO - Scraping data...
2022-01-01 00:32:08,013 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:32:08,056 - root - INFO - Data added to db!
2022-01-01 00:33:02,335 - scrapper - INFO - Scraping data...
2022-01-01 00:33:06,975 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:33:07,008 - root - INFO - Data added to db!
2022-01-01 00:34:02,506 - scrapper - INFO - Scraping data...
2022-01-01 00:34:06,918 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:34:06,950 - root - INFO - Data added to db!
2022-01-01 00:35:01,979 - scrapper - INFO - Scraping data...
2022-01-01 00:35:05,764 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:35:05,794 - root - INFO - Data added to db!
2022-01-01 00:36:03,128 - scrapper - INFO - Scraping data...
2022-01-01 00:36:06,906 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:36:06,937 - root - INFO - Data added to db!
2022-01-01 00:37:02,252 - scrapper - INFO - Scraping data...
2022-01-01 00:37:07,329 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:37:07,377 - root - INFO - Data added to db!
2022-01-01 00:38:02,613 - scrapper - INFO - Scraping data...
2022-01-01 00:38:05,991 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:38:06,012 - root - INFO - Data added to db!
2022-01-01 00:39:01,913 - scrapper - INFO - Scraping data...
2022-01-01 00:39:05,286 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:39:05,315 - root - INFO - Data added to db!
2022-01-01 00:40:02,519 - scrapper - INFO - Scraping data...
2022-01-01 00:40:07,187 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:40:07,230 - root - INFO - Data added to db!
2022-01-01 00:41:02,379 - scrapper - INFO - Scraping data...
2022-01-01 00:41:06,256 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:41:06,286 - root - INFO - Data added to db!
2022-01-01 00:42:02,178 - scrapper - INFO - Scraping data...
2022-01-01 00:42:05,796 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:42:05,833 - root - INFO - Data added to db!
2022-01-01 00:43:02,254 - scrapper - INFO - Scraping data...
2022-01-01 00:43:06,203 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:43:06,237 - root - INFO - Data added to db!
2022-01-01 00:44:02,166 - scrapper - INFO - Scraping data...
2022-01-01 00:44:06,102 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:44:06,130 - root - INFO - Data added to db!
2022-01-01 00:45:02,218 - scrapper - INFO - Scraping data...
2022-01-01 00:45:06,800 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:45:06,844 - root - INFO - Data added to db!
2022-01-01 00:46:01,849 - scrapper - INFO - Scraping data...
2022-01-01 00:46:05,460 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:46:05,493 - root - INFO - Data added to db!
2022-01-01 00:47:02,466 - scrapper - INFO - Scraping data...
2022-01-01 00:47:05,738 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:47:05,769 - root - INFO - Data added to db!
2022-01-01 00:48:02,662 - scrapper - INFO - Scraping data...
2022-01-01 00:48:06,232 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:48:06,262 - root - INFO - Data added to db!
2022-01-01 00:49:02,172 - scrapper - INFO - Scraping data...
2022-01-01 00:49:05,581 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:49:05,616 - root - INFO - Data added to db!
2022-01-01 00:50:02,621 - scrapper - INFO - Scraping data...
2022-01-01 00:50:06,147 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:50:06,177 - root - INFO - Data added to db!
2022-01-01 00:51:02,292 - scrapper - INFO - Scraping data...
2022-01-01 00:51:06,207 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:51:06,237 - root - INFO - Data added to db!
2022-01-01 00:52:02,150 - scrapper - INFO - Scraping data...
2022-01-01 00:52:05,834 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:52:05,862 - root - INFO - Data added to db!
2022-01-01 00:53:01,803 - scrapper - INFO - Scraping data...
2022-01-01 00:53:05,109 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:53:05,143 - root - INFO - Data added to db!
2022-01-01 00:54:02,108 - scrapper - INFO - Scraping data...
2022-01-01 00:54:05,567 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:54:05,597 - root - INFO - Data added to db!
2022-01-01 00:55:02,550 - scrapper - INFO - Scraping data...
2022-01-01 00:55:05,851 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:55:05,881 - root - INFO - Data added to db!
2022-01-01 00:56:01,803 - scrapper - INFO - Scraping data...
2022-01-01 00:56:05,460 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:56:05,490 - root - INFO - Data added to db!
2022-01-01 00:57:02,404 - scrapper - INFO - Scraping data...
2022-01-01 00:57:05,657 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:57:05,689 - root - INFO - Data added to db!
2022-01-01 00:58:02,648 - scrapper - INFO - Scraping data...
2022-01-01 00:58:06,391 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:58:06,427 - root - INFO - Data added to db!
2022-01-01 00:59:02,405 - scrapper - INFO - Scraping data...
2022-01-01 00:59:05,690 - scrapper - INFO - Data scrapped successfully!
2022-01-01 00:59:05,718 - root - INFO - Data added to db!
2022-01-01 01:00:02,656 - scrapper - INFO - Scraping data...
2022-01-01 01:00:06,897 - scrapper - INFO - Data scrapped successfully!
2022-01-01 01:00:06,925 - root - INFO - Data added to db!
2022-01-01 01:13:56,053 - scrapper - INFO - Scraping data...
2022-01-01 01:13:59,494 - scrapper - INFO - Data scrapped successfully!
2022-01-01 01:13:59,531 - root - ERROR - Exception occured!
Traceback (most recent call last):
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1803, in _execute_context
    cursor, statement, parameters, context
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'covid_kenya.data' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/daniel/Desktop/covid19_kenya/scraper/new_scraper/worker.py", line 28, in store_db
    session.commit()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1431, in commit
    self._transaction.commit(_to_root=self.future)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3363, in flush
    self._flush(objects)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3503, in _flush
    transaction.rollback(_capture_exception=True)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3463, in _flush
    flush_context.execute()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/unitofwork.py", line 633, in execute
    uow,
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/persistence.py", line 249, in save_obj
    insert,
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/orm/persistence.py", line 1224, in _emit_insert_statements
    execution_options=execution_options,
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1614, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 326, in _execute_on_connection
    self, multiparams, params, execution_options
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1491, in _execute_clauseelement
    cache_hit=cache_hit,
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2027, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1803, in _execute_context
    cursor, statement, parameters, context
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/daniel/Desktop/covid19_kenya/venv/lib/python3.7/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'covid_kenya.data' doesn't exist")
[SQL: INSERT INTO data (country_name, total_cases, new_cases, total_deaths, new_deaths, total_recovered, new_recovered, active_cases, serious_cases, total_cases_per_m, deaths_per_m, total_tests, tests_per_m, population, new_cases_per_m) VALUES (%(country_name)s, %(total_cases)s, %(new_cases)s, %(total_deaths)s, %(new_deaths)s, %(total_recovered)s, %(new_recovered)s, %(active_cases)s, %(serious_cases)s, %(total_cases_per_m)s, %(deaths_per_m)s, %(total_tests)s, %(tests_per_m)s, %(population)s, %(new_cases_per_m)s)]
[parameters: {'country_name': 'Kenya', 'total_cases': 295028, 'new_cases': 2791, 'total_deaths': 5378, 'new_deaths': 2, 'total_recovered': 252281, 'new_recovered': 1058, 'active_cases': 37369, 'serious_cases': 41, 'total_cases_per_m': 5312, 'deaths_per_m': 97, 'total_tests': 3030272, 'tests_per_m': 54561, 'population': 55538661, 'new_cases_per_m': 0}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-01-01 01:18:39,166 - scrapper - INFO - Creating tables
2022-01-01 01:18:39,203 - scrapper - INFO - Scraping data...
2022-01-01 01:18:42,933 - scrapper - INFO - Data scrapped successfully!
2022-01-01 01:18:42,952 - scrapper - INFO - Data added to db!
2022-01-01 01:19:00,391 - scrapper - INFO - Creating tables
2022-01-01 01:19:00,435 - scrapper - INFO - Scraping data...
2022-01-01 01:19:04,088 - scrapper - INFO - Data scrapped successfully!
2022-01-01 01:19:04,110 - scrapper - INFO - Data added to db!
2022-01-01 01:25:36,110 - scrapper - INFO - Scraping data...
2022-01-01 01:25:39,797 - scrapper - INFO - Data scrapped successfully!
2022-01-01 01:25:39,831 - scrapper - INFO - Data added to db!
